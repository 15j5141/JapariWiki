!function(t){var e={};function r(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(n,s,function(e){return t[e]}.bind(null,s));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=97)}({0:function(t,e,r){"use strict";r.d(e,"a",(function(){return s}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function s(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}},1:function(t,e,r){"use strict";r.d(e,"a",(function(){return h}));var n=r(0),s=r(12),i=r(11),o=r(4),c=r(8),a=r(5),u=r(7),h=function(t){function e(r,n,s){var o=t.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=i.a;break;case 1:if(!r){o.destination=i.a;break}if("object"==typeof r){r instanceof e?(o.syncErrorThrowable=r.syncErrorThrowable,o.destination=r,r.add(o)):(o.syncErrorThrowable=!0,o.destination=new l(o,r));break}default:o.syncErrorThrowable=!0,o.destination=new l(o,r,n,s)}return o}return n.a(e,t),e.prototype[c.a]=function(){return this},e.create=function(t,r,n){var s=new e(t,r,n);return s.syncErrorThrowable=!1,s},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this},e}(o.a),l=function(t){function e(e,r,n,o){var c,a=t.call(this)||this;a._parentSubscriber=e;var u=a;return Object(s.a)(r)?c=r:r&&(c=r.next,n=r.error,o=r.complete,r!==i.a&&(u=Object.create(r),Object(s.a)(u.unsubscribe)&&a.add(u.unsubscribe.bind(u)),u.unsubscribe=a.unsubscribe.bind(a))),a._context=u,a._next=c,a._error=n,a._complete=o,a}return n.a(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;a.a.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,r=a.a.useDeprecatedSynchronousErrorHandling;if(this._error)r&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)r?(e.syncErrorValue=t,e.syncErrorThrown=!0):Object(u.a)(t),this.unsubscribe();else{if(this.unsubscribe(),r)throw t;Object(u.a)(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var r=function(){return t._complete.call(t._context)};a.a.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),a.a.useDeprecatedSynchronousErrorHandling)throw t;Object(u.a)(t)}},e.prototype.__tryOrSetError=function(t,e,r){if(!a.a.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,r)}catch(e){return a.a.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0,!0):(Object(u.a)(e),!0)}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(h)},11:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(5),s=r(7),i={closed:!0,next:function(t){},error:function(t){if(n.a.useDeprecatedSynchronousErrorHandling)throw t;Object(s.a)(t)},complete:function(){}}},12:function(t,e,r){"use strict";function n(t){return"function"==typeof t}r.d(e,"a",(function(){return n}))},13:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(2),s=r(4);function i(t,e){return new n.a((function(r){var n=new s.a,i=0;return n.add(e.schedule((function(){i!==t.length?(r.next(t[i++]),r.closed||n.add(this.schedule())):r.complete()}))),n}))}},14:function(t,e){t.exports={JW_CLOUD_APPLICATION_ID:"Q5BkzYpYGt0sshPj",JW_CLOUD_APP_KEY:"73214ee5293b310aba334aaf6b58cb41cb89873a1eb88ab505fa7d48dcc2b911",JW_CLOUD_NAME:"ncmb",JW_SITE_NAME:"JapariWiki_v2.2.4",JW_CLOUD_CLIENT_KEY:"79d3a32839ef780c0fe16236d8efc7bdd338312ec1d969945346a181ffc9442f"}},15:function(t,e,r){"use strict";r.d(e,"a",(function(){return s}));var n=r(0),s=function(t){function e(e,r){var n=t.call(this)||this;return n.subject=e,n.subscriber=r,n.closed=!1,n}return n.a(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var r=e.indexOf(this.subscriber);-1!==r&&e.splice(r,1)}}},e}(r(4).a)},16:function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}()},18:function(t,e,r){"use strict";function n(t){return null!==t&&"object"==typeof t}r.d(e,"a",(function(){return n}))},19:function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=function(t){return function(e){for(var r=0,n=t.length;r<n&&!e.closed;r++)e.next(t[r]);e.complete()}}},2:function(t,e,r){"use strict";r.d(e,"a",(function(){return h}));var n=r(1);var s=r(8),i=r(11);var o=r(16);function c(t){return t}function a(t){return 0===t.length?c:1===t.length?t[0]:function(e){return t.reduce((function(t,e){return e(t)}),e)}}var u=r(5),h=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var r=new t;return r.source=this,r.operator=e,r},t.prototype.subscribe=function(t,e,r){var o=this.operator,c=function(t,e,r){if(t){if(t instanceof n.a)return t;if(t[s.a])return t[s.a]()}return t||e||r?new n.a(t,e,r):new n.a(i.a)}(t,e,r);if(o?c.add(o.call(c,this.source)):c.add(this.source||u.a.useDeprecatedSynchronousErrorHandling&&!c.syncErrorThrowable?this._subscribe(c):this._trySubscribe(c)),u.a.useDeprecatedSynchronousErrorHandling&&c.syncErrorThrowable&&(c.syncErrorThrowable=!1,c.syncErrorThrown))throw c.syncErrorValue;return c},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){u.a.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),!function(t){for(;t;){var e=t,r=e.closed,s=e.destination,i=e.isStopped;if(r||i)return!1;t=s&&s instanceof n.a?s:null}return!0}(t)?console.warn(e):t.error(e)}},t.prototype.forEach=function(t,e){var r=this;return new(e=l(e))((function(e,n){var s;s=r.subscribe((function(e){try{t(e)}catch(t){n(t),s&&s.unsubscribe()}}),n,e)}))},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[o.a]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?this:a(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=l(t))((function(t,r){var n;e.subscribe((function(t){return n=t}),(function(t){return r(t)}),(function(){return t(n)}))}))},t.create=function(e){return new t(e)},t}();function l(t){if(t||(t=u.a.Promise||Promise),!t)throw new Error("no Promise impl found");return t}},20:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(2),s=new n.a((function(t){return t.complete()}));function i(t){return t?function(t){return new n.a((function(e){return t.schedule((function(){return e.complete()}))}))}(t):s}},21:function(t,e,r){"use strict";r.d(e,"a",(function(){return l}));var n=r(0),s=r(2),i=r(1),o=r(4),c=r(6),a=r(15),u=r(8),h=function(t){function e(e){var r=t.call(this,e)||this;return r.destination=e,r}return n.a(e,t),e}(i.a),l=function(t){function e(){var e=t.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return n.a(e,t),e.prototype[u.a]=function(){return new h(this)},e.prototype.lift=function(t){var e=new p(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new c.a;if(!this.isStopped)for(var e=this.observers,r=e.length,n=e.slice(),s=0;s<r;s++)n[s].next(t)},e.prototype.error=function(t){if(this.closed)throw new c.a;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,r=e.length,n=e.slice(),s=0;s<r;s++)n[s].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new c.a;this.isStopped=!0;for(var t=this.observers,e=t.length,r=t.slice(),n=0;n<e;n++)r[n].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new c.a;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new c.a;return this.hasError?(t.error(this.thrownError),o.a.EMPTY):this.isStopped?(t.complete(),o.a.EMPTY):(this.observers.push(t),new a.a(this,t))},e.prototype.asObservable=function(){var t=new s.a;return t.source=this,t},e.create=function(t,e){return new p(t,e)},e}(s.a),p=function(t){function e(e,r){var n=t.call(this)||this;return n.destination=e,n.source=r,n}return n.a(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):o.a.EMPTY},e}(l)},22:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(0),s=function(){function t(e,r){void 0===r&&(r=t.now),this.SchedulerAction=e,this.now=r}return t.prototype.schedule=function(t,e,r){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(r,e)},t.now=function(){return Date.now()},t}(),i=function(t){function e(r,n){void 0===n&&(n=s.now);var i=t.call(this,r,(function(){return e.delegate&&e.delegate!==i?e.delegate.now():n()}))||this;return i.actions=[],i.active=!1,i.scheduled=void 0,i}return n.a(e,t),e.prototype.schedule=function(r,n,s){return void 0===n&&(n=0),e.delegate&&e.delegate!==this?e.delegate.schedule(r,n,s):t.prototype.schedule.call(this,r,n,s)},e.prototype.flush=function(t){var e=this.actions;if(this.active)e.push(t);else{var r;this.active=!0;do{if(r=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,r){for(;t=e.shift();)t.unsubscribe();throw r}}},e}(s)},23:function(t,e,r){"use strict";r.d(e,"a",(function(){return s}));var n=r(0),s=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.scheduler=e,n.work=r,n.pending=!1,n}return n.a(e,t),e.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t;var r=this.id,n=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(n,r,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(n,this.id,e),this},e.prototype.requestAsyncId=function(t,e,r){return void 0===r&&(r=0),setInterval(t.flush.bind(t,this),r)},e.prototype.recycleAsyncId=function(t,e,r){if(void 0===r&&(r=0),null!==r&&this.delay===r&&!1===this.pending)return e;clearInterval(e)},e.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var r=this._execute(t,e);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,e){var r=!1,n=void 0;try{this.work(t)}catch(t){r=!0,n=!!t&&t||new Error(t)}if(r)return this.unsubscribe(),n},e.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,r=e.actions,n=r.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==n&&r.splice(n,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},e}(function(t){function e(e,r){return t.call(this)||this}return n.a(e,t),e.prototype.schedule=function(t,e){return void 0===e&&(e=0),this},e}(r(4).a))},24:function(t,e,r){"use strict";r.d(e,"a",(function(){return s}));var n=r(2);function s(t,e){return e?new n.a((function(r){return e.schedule(i,0,{error:t,subscriber:r})})):new n.a((function(e){return e.error(t)}))}function i(t){var e=t.error;t.subscriber.error(e)}},25:function(t,e,r){"use strict";function n(t){return t&&"function"==typeof t.schedule}r.d(e,"a",(function(){return a}));var s=r(2),i=r(19),o=r(13);function c(t,e){return e?Object(o.a)(t,e):new s.a(Object(i.a)(t))}function a(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=t[t.length-1];return n(r)?(t.pop(),Object(o.a)(t,r)):c(t)}},27:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(0),s=r(1);function i(t,e){return function(r){return r.lift(new o(t,e))}}var o=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new c(t,this.predicate,this.thisArg))},t}(),c=function(t){function e(e,r,n){var s=t.call(this,e)||this;return s.predicate=r,s.thisArg=n,s.count=0,s}return n.a(e,t),e.prototype._next=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}e&&this.destination.next(t)},e}(s.a)},3:function(t,e,r){"use strict";r.d(e,"c",(function(){return _})),r.d(e,"i",(function(){return v})),r.d(e,"a",(function(){return E})),r.d(e,"e",(function(){return S})),r.d(e,"b",(function(){return T})),r.d(e,"f",(function(){return N})),r.d(e,"j",(function(){return j})),r.d(e,"d",(function(){return L})),r.d(e,"h",(function(){return U})),r.d(e,"g",(function(){return C})),r.d(e,"k",(function(){return D})),r.d(e,"l",(function(){return A}));var n,s=r(0),i=r(21),o=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.scheduler=e,n.work=r,n}return s.a(e,t),e.prototype.schedule=function(e,r){return void 0===r&&(r=0),r>0?t.prototype.schedule.call(this,e,r):(this.delay=r,this.state=e,this.scheduler.flush(this),this)},e.prototype.execute=function(e,r){return r>0||this.closed?t.prototype.execute.call(this,e,r):this._execute(e,r)},e.prototype.requestAsyncId=function(e,r,n){return void 0===n&&(n=0),null!==n&&n>0||null===n&&this.delay>0?t.prototype.requestAsyncId.call(this,e,r,n):e.flush(this)},e}(r(23).a),c=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s.a(e,t),e}(r(22).a))(o),a=r(4),u=r(1),h=r(20),l=r(25),p=r(24);n||(n={});var d=function(){function t(t,e,r){this.kind=t,this.value=e,this.error=r,this.hasValue="N"===t}return t.prototype.observe=function(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}},t.prototype.do=function(t,e,r){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return r&&r()}},t.prototype.accept=function(t,e,r){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,r)},t.prototype.toObservable=function(){switch(this.kind){case"N":return Object(l.a)(this.value);case"E":return Object(p.a)(this.error);case"C":return Object(h.a)()}throw new Error("unexpected notification kind value")},t.createNext=function(e){return void 0!==e?new t("N",e):t.undefinedValueNotification},t.createError=function(e){return new t("E",void 0,e)},t.createComplete=function(){return t.completeNotification},t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t}();var f=function(t){function e(e,r,n){void 0===n&&(n=0);var s=t.call(this,e)||this;return s.scheduler=r,s.delay=n,s}return s.a(e,t),e.dispatch=function(t){var e=t.notification,r=t.destination;e.observe(r),this.unsubscribe()},e.prototype.scheduleMessage=function(t){this.destination.add(this.scheduler.schedule(e.dispatch,this.delay,new m(t,this.destination)))},e.prototype._next=function(t){this.scheduleMessage(d.createNext(t))},e.prototype._error=function(t){this.scheduleMessage(d.createError(t)),this.unsubscribe()},e.prototype._complete=function(){this.scheduleMessage(d.createComplete()),this.unsubscribe()},e}(u.a),m=function(){return function(t,e){this.notification=t,this.destination=e}}(),b=r(6),w=r(15),y=function(t){function e(e,r,n){void 0===e&&(e=Number.POSITIVE_INFINITY),void 0===r&&(r=Number.POSITIVE_INFINITY);var s=t.call(this)||this;return s.scheduler=n,s._events=[],s._infiniteTimeWindow=!1,s._bufferSize=e<1?1:e,s._windowTime=r<1?1:r,r===Number.POSITIVE_INFINITY?(s._infiniteTimeWindow=!0,s.next=s.nextInfiniteTimeWindow):s.next=s.nextTimeWindow,s}return s.a(e,t),e.prototype.nextInfiniteTimeWindow=function(e){if(!this.isStopped){var r=this._events;r.push(e),r.length>this._bufferSize&&r.shift()}t.prototype.next.call(this,e)},e.prototype.nextTimeWindow=function(e){this.isStopped||(this._events.push(new g(this._getNow(),e)),this._trimBufferThenGetEvents()),t.prototype.next.call(this,e)},e.prototype._subscribe=function(t){var e,r=this._infiniteTimeWindow,n=r?this._events:this._trimBufferThenGetEvents(),s=this.scheduler,i=n.length;if(this.closed)throw new b.a;if(this.isStopped||this.hasError?e=a.a.EMPTY:(this.observers.push(t),e=new w.a(this,t)),s&&t.add(t=new f(t,s)),r)for(var o=0;o<i&&!t.closed;o++)t.next(n[o]);else for(o=0;o<i&&!t.closed;o++)t.next(n[o].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),e},e.prototype._getNow=function(){return(this.scheduler||c).now()},e.prototype._trimBufferThenGetEvents=function(){for(var t=this._getNow(),e=this._bufferSize,r=this._windowTime,n=this._events,s=n.length,i=0;i<s&&!(t-n[i].time<r);)i++;return s>e&&(i=Math.max(i,s-e)),i>0&&n.splice(0,i),n},e}(i.a),g=function(){return function(t,e){this.time=t,this.value=e}}();class _{constructor(t){this.refObj={selectorForGetElement:null,serviceManager:null,declarations:null,element:null,...t},this.$=top.jQuery,this.selector=this.decoration.selector,this.element=this.refObj.element||this.$(this.refObj.selectorForGetElement).get(0)||this.$(this.selector).get(0),this.$element=this.$(this.element),this.renderer=new U(this.element),this.isInitialized=!1,this.serviceInjection={},this.decorator(),this.stylesLinkTag=this.decoration.styleUrls.reduce((t,e)=>t+`<link rel="stylesheet" type="text/css" href="app/${e}" />\n`,""),this.stylesLinkTag+=this.decoration.styles?"<style>"+this.decoration.styles.join("\n")+"</style>":"",this.templateHTML=this.loadTemplate(),this.init().then(()=>{})}static get classes$(){return this._classes$=this._classes$||new y,this._classes$}static get decoration(){return this.prototype.decoration}get decoration(){return{templateUrl:null,template:"",styleUrls:[],styles:[],selector:""}}decorator(){}async _inject(){const t=this;await Promise.all([...Object.keys(t.serviceInjection).map(e=>new Promise((r,n)=>{t.refObj.serviceManager.getService(t.serviceInjection[e]).subscribe(n=>{t.serviceInjection[e]=n,r()})}))])}async _initChildComponents(){const t=this,e=[];this.refObj.declarations.forEach(r=>{const n=t.element.querySelectorAll(r.decoration.selector);for(let t=0;t<n.length;t++){const s=n[t];s.classList.add("jw-component"),e.push(new r({...this.refObj,element:s}))}})}async onInit(){return Error("Not implemented")}async onRender(){await this.renderer.update(await this.templateHTML)}onLoad(){}onStart(){}async init(){await this._inject(),await this.onInit(),await this.templateHTML,await this.draw(),await this._initChildComponents(),this.onStart(),this.isInitialized=!0,this.onLoad()}async draw(){await this.onRender()}show(){this.$element.show()}hide(){this.$element.hide()}async loadTemplate(){const t=this,e=t.decoration.templateUrl;return null==e?Promise.resolve(t.stylesLinkTag+(t.decoration.template||"")):new Promise((r,n)=>{t.$.ajax({url:"./app/"+e,success:e=>{r(t.stylesLinkTag+e)},error:t=>{n(t)}})})}async fetch(t){const e=this.$;return new Promise((r,n)=>{e.ajax({url:t}).done(t=>{r(t)})})}}class v{constructor(t){this.componentsManager=t.componentsManager,this.serviceManager=t.serviceManager,this.serviceInjection={},this.decoration={},this.decorator(),this._inject().then(()=>{this.onStart()})}get[Symbol.toStringTag](){return"PleaseOverrideServiceName"}decorator(){}async _inject(){const t=this;await Promise.all([...Object.keys(t.serviceInjection).map(e=>new Promise((r,n)=>{t.serviceManager.getService(t.serviceInjection[e]).subscribe(n=>{t.serviceInjection[e]=n,r()})}))])}open(){}onCreate(){}onStart(){}onResume(){}onPause(){}onStop(){}onDestroy(){}onRestart(){}}class E{constructor(){}getPage(t){throw new Error("Not Implemented")}putPage(t){throw new Error("Not Implemented")}deletePage(t){throw new Error("Not Implemented")}postPage(t){throw new Error("Not Implemented")}async getPageHistory(){throw new Error("Not Implemented")}async isLogin(){throw new Error("Not Implemented")}signIn(t,e){throw new Error("Not Implemented")}signUp(t,e){throw new Error("Not Implemented")}signOut(){throw new Error("Not Implemented")}async getFile(t){throw new Error("Not Implemented")}async postFile(t){throw new Error("Not Implemented")}async putFile(t){throw new Error("Not Implemented")}async deleteFile(t){throw new Error("Not Implemented")}async getFileLink(t){throw new Error("Not Implemented")}async getFileNames(t){throw new Error("Not Implemented")}async getLoginHistory(){throw new Error("Not Implemented")}async addLoginHistory(t,e){throw new Error("Not Implemented")}}class S{constructor(t,e,r){this.pageURI=t||"notitle",this.rawText=e,this.authorObject={id:"id",editable:{},...r},this.cloudObject=null,this.error={}}static isAbsoluteURI(t){return 0===t.indexOf("/")}}var I=r(14),x=r.n(I);class T extends E{constructor(){super(),this.appKey=x.a.JW_CLOUD_APP_KEY||"",this.clientKey=x.a.JW_CLOUD_CLIENT_KEY||"",this.APPLICATION_ID=x.a.JW_CLOUD_APPLICATION_ID,this.instance=this,this.ncmb=new this.NCMB(this.appKey,this.clientKey);this.ncmb.User.getCurrentUser()}get NCMB(){return window.top.NCMB}async getPage(t){const e=this.ncmb.DataStore("Page");return await e.equalTo("path",t).fetch().then((function(e){if(!e.objectId)throw new Error("Page:NotFound");const r=new S(t,e.text);return r.cloudObject=e,r.error={},r})).catch((function(t){const e=t.message.match(/^cannot GET .+ \((\d+)\)$/);throw e&&"401"==e[1]?new Error("JWCloud:Unauthorized"):t}))}async putPage(t){if(null==t.pageURI)throw new Error("err");let e=null;if(t.cloudObject)e=t.cloudObject;else{const r=this.ncmb.DataStore("Page");e=await r.equalTo("path",t.pageURI).fetch()}return console.log("b:",e),e.objectId?await e.set("author",t.authorObject.id).set("path",t.pageURI).set("text",t.rawText).update().catch(t=>{const e=t.message.match(/^cannot GET .+ \((\d+)\)$/);throw e&&"401"==e[1]?new Error("JWCloud:Unauthorized"):t}):await this.postPage(t)}async deletePage(t){const e=this.ncmb.DataStore("Page");return await e.equalTo("path",t.pageURI).fetch().delete().catch((function(t){const e=t.message.match(/^cannot GET .+ \((\d+)\)$/);throw e&&"401"==e[1]?new Error("JWCloud:Unauthorized"):t}))}async postPage(t){const e=new(this.ncmb.DataStore("Page")),r=new this.ncmb.Acl;return await e.set("acl",r).set("author",t.authorObject.id).set("path",t.pageURI).set("text",t.rawText).save().then(t=>t).catch(t=>{const e=t.message.match(/^cannot GET .+ \((\d+)\)$/);throw e&&"401"==e[1]?new Error("JWCloud:Unauthorized"):t})}async listPages(t=10,e=null){let r=this.ncmb.DataStore("Page").limit(t);return e&&(r=r.equalTo("author",e)),await r.fetchAll().then((function(t){return t.map(t=>({path:t.path,author:t.author,updateDate:t.updateDate}))})).catch((function(t){const e=t.message.match(/^cannot GET .+ \((\d+)\)$/);throw e&&"401"==e[1]?new Error("JWCloud:Unauthorized"):t}))}async getPageHistory(){return await this.ncmb.Script.exec("GET","page_history.js").then((function(t){return JSON.parse(t.body)})).catch((function(t){return t}))}async isLogin(){const t=this.ncmb.DataStore("LoginLog");return await t.fetch().then(t=>{const e=this.ncmb.User.getCurrentUser();return{id:e.userName,name:e.userName,updateDate:e.updateDate,createDate:e.createDate}}).catch(t=>{const e=t.message.match(/^cannot GET .+ \((\d+)\)$/);if(e&&"401"==e[1])return null;if(e&&"403"==e[1])return null;throw t})}async signIn(t,e){const r=new this.ncmb.User({userName:t,password:e});try{const t=await this.ncmb.User.login(r);return{id:t.userName,name:t.userName,updateDate:t.updateDate,createDate:t.createDate}}catch(t){const e=t.message.match(/^cannot GET .+ \((\d+)\)$/);throw e&&"401"==e[1]?new Error("JWCloud:Unauthorized"):t}}async signUp(t,e){const r=this,n=new this.ncmb.User;n.set("userName",t).set("password",e);const s=await n.signUpByAccount().catch((function(t){const e=t.message.match(/^cannot GET .+ \((\d+)\)$/);throw e&&"401"==e[1]?new Error("JWCloud:Unauthorized"):e&&"409"==e[1]?new Error("JWCloud:Conflict"):t})),i=await r.ncmb.Role.equalTo("roleName","normal").fetch().catch((function(t){throw new Error("JWCloud:ErrorSearchRole")}));if("{}"===JSON.stringify(i))throw new Error("JWCloud:NotFoundRole");await i.addUser(s).update().then((function(n){return r.signIn(t,e)})).catch((function(t){throw new Error("JWCloud:ErrorAddUserToRole")}))}async signOut(){return await this.ncmb.User.logout().catch(t=>{const e=t.message.match(/^cannot GET .+ \((\d+)\)$/);throw e&&"401"==e[1]?new Error("JWCloud:Unauthorized"):t})}async postFile(t){return await this.ncmb.File.upload(t.filename,t.rawFile).then((function(t){return!0})).catch((function(t){return console.log(t),!1}))}async getFileLink(t){return"https://mbaas.api.nifcloud.com/2013-09-01/applications/"+this.APPLICATION_ID+"/publicFiles/"+t.replace(/[^a-zA-Z0-9_.]/g,"")}async getFileNames(t){const e=this.ncmb.File.order("createDate",!0);return e._where={fileName:{$regex:t}},await e.fetchAll().then((function(t){return t.map(t=>t.fileName)})).catch((function(t){const e=t.message.match(/^cannot GET .+ \((\d+)\)$/);throw e&&"401"==e[1]?new Error("JWCloud:Unauthorized"):t}))}async getLoginHistory(){const t=this.ncmb.DataStore("LoginLog");return await t.order("createDate",!0).limit(50).fetchAll().then((function(t){let e="";if(0===t.length)return console.log(t),e="LoginLog:NotFound",e;for(let r=0;r<t.length;r++){const n=t[r];e+=n.get("createDate")+";"+n.get("status")+";"+n.get("userName")+"<br />\n"}return e})).catch((function(t){const e=t.message.match(/^cannot GET .+ \((\d+)\)$/);if(e&&"401"==e[1])throw new Error("JWCloud:Unauthorized");if(e&&"403"==e[1])return"権限がありません.";throw t}))}async addLoginHistory(t,e){return(new(this.ncmb.DataStore("LoginLog"))).set("status",t).set("userName",e).save().then((function(t){return console.log(t),!0})).catch((function(t){const e=t.message.match(/^cannot GET .+ \((\d+)\)$/);throw e&&"401"==e[1]?new Error("JWCloud:Unauthorized"):t}))}}class N{constructor(){this.statusDefault={app:{pageURI:"/FrontPage",appName:"WikiApp"},user:{id:"id",name:"name"}},this._status=this.statusDefault,this.load(),this.save()}load(){const t=sessionStorage.getItem("JW_Status"),e={...this.statusDefault,...JSON.parse(t)},r=new URL(window.location.href),n=r.searchParams;this._status.user=e.user,this._status.app={pageURI:this.resolveURI(n.get("pageURI")||window.history.state&&window.history.state.pageURI||e.app.pageURI),appName:n.get("appName")||window.history.state&&window.history.state.appName||e.app.appName},n.delete("appName"),n.delete("pageURI"),window.history.replaceState(this._status.app,this._status.app.appName+": "+this._status.app.pageURI,r.href)}save(){const t=JSON.stringify(this._status);sessionStorage.setItem("JW_Status",t)}getPageURI(){return this._status.app.pageURI}setPageURI(t){this._status.app.pageURI=this.resolveURI(t)}resolveURI(t){if(S.isAbsoluteURI(t))return t;{const e=this.getPageURI().split("/");return e[e.length-1]=t,e.join("/")}}getSign(){return null}}var O=function(){function t(t,e,r,n){this.predicate=t,this.source=e,this.yieldIndex=r,this.thisArg=n}return t.prototype.call=function(t,e){return e.subscribe(new $(t,this.predicate,this.source,this.yieldIndex,this.thisArg))},t}(),$=function(t){function e(e,r,n,s,i){var o=t.call(this,e)||this;return o.predicate=r,o.source=n,o.yieldIndex=s,o.thisArg=i,o.index=0,o}return s.a(e,t),e.prototype.notifyComplete=function(t){var e=this.destination;e.next(t),e.complete(),this.unsubscribe()},e.prototype._next=function(t){var e=this.predicate,r=this.thisArg,n=this.index++;try{e.call(r||this,t,n,this.source)&&this.notifyComplete(this.yieldIndex?n:t)}catch(t){this.destination.error(t)}},e.prototype._complete=function(){this.notifyComplete(this.yieldIndex?-1:void 0)},e}(u.a);class j{constructor(){this.services$=new y}register(t){this.services$.next(t)}getService(t){return this.services$.pipe(function(t,e){if("function"!=typeof t)throw new TypeError("predicate is not a function");return function(r){return r.lift(new O(t,r,!1,e))}}(e=>e.toString()===t.toString()))}}var P=r(27);class L{constructor(){this.components$=new y}register(t){this.components$.next(t)}getComponents(t){return this.components$.pipe(Object(P.a)(e=>e.constructor.name===t.constructor.name))}}class U{constructor(t){this.element=t,this.html$=new i.a,this.html$.subscribe(async t=>{const e={selector:"",type:"html",value:"",...t},r=""==e.selector||null==e.selector?[this.element]:Array.from(this.element.querySelectorAll(e.selector));""===e.selector&&"html"===e.type?await this.update(e.value):"html"===e.type?r.map(t=>{t.innerHTML=e.value}):"text"===e.type?r.map(t=>{t.textContent=e.value}):"append"===e.type?r.map(t=>{t.innerHTML=t.innerHTML+e.value}):"prepend"===e.type&&r.map(t=>{t.innerHTML=e.value+t.innerHTML})})}setHTML(t){this.element.innerHTML=t}setText(t){this.element.textContent=t}print(t){this.element.innerHTML+=t}println(t){this.element.innerHTML+=t+"</br>"}cls(){this.element.innerHTML=null}async update(t){return this.setHTML(t),t}}class C extends U{constructor(t,e){super(t),this._cloud=new T,this._jwStatus=new N,this._pageURI=e,this.syntaxes=[new A("")]}async update(t=null){let e=t;!e&&this._pageURI&&(this.println("Downloading."),e=(await this._cloud.getPage(this._pageURI)).rawText),this.println("Checking Syntax."),e=await this.convert(e),this.println("Checked Syntax .");const r=top.$;return r(this.element).fadeOut("fast",()=>{this.setHTML(e),r(this.element).fadeIn("1")}),e}async convert(t){let e=t;for(let t=0;t<this.syntaxes.length;t++)e=await this.syntaxes[t].checkAfterLoadingPage(e);return e}}class D{constructor(t){this.rawText=t,this.text=t,this._cloud=new T}async checkBeforeSavingPage(t){throw new Error("Not Implemented")}async checkAfterLoadingPage(t){throw new Error("Not Implemented")}replaceSyntax(t){throw new Error("Not Implemented")}async run(){throw new Error("Not Implemented")}}class A extends D{constructor(t){super(t),this._cloud=new T,this.uploadedImageLink="up/",(async()=>{this.uploadedImageLink=(await this._cloud.getFileLink("CONST")).replace(/CONST/,"")})()}async checkBeforeSavingPage(t){const e=t;return await A.checkNewCommentForm(e).catch(t=>{throw t})}async checkAfterLoadingPage(t){let e=t;return e=await this.checkComment(e),e=this.replaceSyntax(e),e}static async checkNewCommentForm(t){let e=t;return/#comment\(\s*\)/.test(t)&&(e=e.replace(/#comment\(\s*\)/g,(function(t){return"#comment("+A.rndStr(10)+")"}))),e}async checkComment(t){const e=this;let r=t;const n=/#comment\(([a-zA-Z0-9]{6,10})\)/g,s=new k;let i;const o=[];for(;null!==(i=n.exec(r));)o.push(i[1]);const c={};o.forEach(t=>c[t]=[]);const a=o.map(t=>s.getComment(t)),u=await Promise.all(a).catch(t=>{throw t});for(let t=0;t<u.length;t++)c[u[t].commentObjectId]=u[t].data;return Object.keys(c).forEach((function(t){const n='<div class="WikiSyntax_Comment"><form class="CommentForm" data-objid="'+t+'"><input type="text" name="content" size="25" value="" placeholder="コメント本文" /><input type="text" name="contributor" size="10" value="" placeholder="名前" /><input type="submit" value="投稿" /></form><ul>'+c[t].map(t=>`<li>${e.replaceSyntax(t.contributor)}: ${e.replaceSyntax(t.content)}</li>`).reduce((t,e)=>t+e,"")+"</ul></div>";r=r.replace("#comment("+t+")",n)})),r}static rndStr(t){const e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let r="",n=0;for(;n<t;)r+=e[Math.floor(Math.random()*e.length)],n++;return r}replaceSyntax(t){const e=[];let r=t;e.push([/&image\((\w+\.\w+)\)/g,'<img src="'+this.uploadedImageLink+'$1" class="tag" style="max-width:360px;" />']),e.push([/&image\((\w+\.\w+),([0-9]*),([0-9]*)\)/g,'<img src="'+this.uploadedImageLink+'$1" class="tag" style="width:$2px;height:$3px;" />']),e.push([/&img\((https?:\/\/.+)\)/g,'<img src="$1" class="tag" style="width:200px;" />']),e.push([/&size\((\d+)\)\{(.*)\}/g,'<span style="font-size:$1px">$2</span>']),e.push([/&color\((#[0-9A-F]{6})\)\{(.*)\}/g,'<span style="color:$1">$2</span>']),e.push([/\[\[(.+?)::(https?:\/\/.+?)]]/g,'<a value="$2" href="$2" target=" _blank">$1</a>']),e.push([/\[\[(.+?)::(.+)]]/g,'<a data-page="$2" href="?pageURI=$2" class="ajaxLoad">$1</a>']),e.push([/\[\[(.+?)]]/g,'<a data-page="$1" href="?pageURI=$1" class="ajaxLoad">$1</a>']),e.push([/\[\[#([a-z][a-f0-9]{7})]]/g,'<a class="page_pos" value="$1" href="#$1">$1</a>']),e.push([/\[\[(.+?)::#([a-z][a-f0-9]{7})]]/g,'<a class="page_pos" value="$2" href="#$2">$1</a>']),e.push([/%%(.+?)%%/g,"<s>$1</s>"]),e.push([/'''(.+?)'''/g,"<i>$1</i>"]),e.push([/''(.+?)''/g,"<strong>$1</strong>"]),e.push([/#hr\s*/g,"<hr>"]),e.push([/#[cC]ode([\s\S]*?)#[eE]nd/g,"<code>$1</code>"]),e.push([/(^|[^:])\/\/.*/g,"__NewLine__"]),e.push([/\/\*[\s\S]*?\*\//g,""]),e.push([/^\*\*\*(.*) \[#([a-z][a-f0-9]{7})\](.*)$/gm,'<p class="Asta3" id="$2">$1</p>__NewLine__']),e.push([/^\*\*(.*) \[#([a-z][a-f0-9]{7})\](.*)$/gm,'<p class="Asta2" id="$2">$1</p>__NewLine__']),e.push([/^\*(.*) \[#([a-z][a-f0-9]{7})\](.*)$/gm,'<p class="Asta1" id="$2">$1</p>__NewLine__']),e.push([/^\*\*\*(.*)$/gm,'<p class="asta3">$1</p>__NewLine__']),e.push([/^\*\*(.*)$/gm,'<p class="asta2">$1</p>__NewLine__']),e.push([/^\*(.*)$/gm,'<p class="asta1">$1</p>__NewLine__']),e.push([/^---(.+)$/gm,'<ul><ul><ul type="square"><li>$1</li></ul></ul></ul>__NewLine__']),e.push([/^--(.+)$/gm,'<ul><ul type="circle"><li>$1</li></ul></ul>__NewLine__']),e.push([/^-(.+)$/gm,'<ul type="disc"><li>$1</li></ul>__NewLine__']),e.push([/^\|(.*\|)[^|\n]*$/gm,(...t)=>"<table><tr>"+t[1].replace(/(.*?)\|/g,"<td>$1</td>")+"</tr></table>__NewLine__"]),e.push([/&countdown\((\d{4}\/[0-1]?\d\/[0-3]?\d)(,day)?\)/g,(...t)=>{const e=(new Date(t[1]).getTime()-Date.now())/1e3/60/60/24;return-1<e&&e<1?"今":""+e}]),e.push([/&new\((text,)?(\d{4}\/[0-1]?\d\/[0-3]?\d).*?\)/g,(...t)=>{new Date(t[2]).getTime(),Date.now();return"[未実装構文]"}]),e.push([/^#contents\(page=(.*)\)$\n/gm,"[未実装構文]"]);for(let t=0;t<e.length;t++)r=r.replace(e[t][0],e[t][1]);return r=r.replace(/__NewLine__\r?\n/g,""),r=r.replace("__NewLine__",""),r=r.replace(/\r?\n/g,"<br>"),r}}class k{constructor(){this._cloud=new T}async getComment(t){const e=this._cloud.ncmb.DataStore("Comment");return{commentObjectId:t,data:await e.equalTo("commentObjectId",t).order("createDate",!0).fetchAll().catch(t=>{throw console.log(t),t})}}async setComment(t,e,r){const n=new(this._cloud.ncmb.DataStore("Comment"));return await n.set("commentObjectId",t).set("content",e).set("contributor",r).save().catch(t=>{throw t})}}},4:function(t,e,r){"use strict";r.d(e,"a",(function(){return c}));var n=function(){return Array.isArray||function(t){return t&&"number"==typeof t.length}}(),s=r(18),i=r(12),o=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}(),c=function(){function t(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}var e;return t.prototype.unsubscribe=function(){var e;if(!this.closed){var r=this._parentOrParents,c=this._ctorUnsubscribe,u=this._unsubscribe,h=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,r instanceof t)r.remove(this);else if(null!==r)for(var l=0;l<r.length;++l){r[l].remove(this)}if(Object(i.a)(u)){c&&(this._unsubscribe=void 0);try{u.call(this)}catch(t){e=t instanceof o?a(t.errors):[t]}}if(n(h)){l=-1;for(var p=h.length;++l<p;){var d=h[l];if(Object(s.a)(d))try{d.unsubscribe()}catch(t){e=e||[],t instanceof o?e=e.concat(a(t.errors)):e.push(t)}}}if(e)throw new o(e)}},t.prototype.add=function(e){var r=e;if(!e)return t.EMPTY;switch(typeof e){case"function":r=new t(e);case"object":if(r===this||r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if(!(r instanceof t)){var n=r;(r=new t)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var s=r._parentOrParents;if(null===s)r._parentOrParents=this;else if(s instanceof t){if(s===this)return r;r._parentOrParents=[s,this]}else{if(-1!==s.indexOf(this))return r;s.push(this)}var i=this._subscriptions;return null===i?this._subscriptions=[r]:i.push(r),r},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var r=e.indexOf(t);-1!==r&&e.splice(r,1)}},t.EMPTY=((e=new t).closed=!0,e),t}();function a(t){return t.reduce((function(t,e){return t.concat(e instanceof o?e.errors:e)}),[])}},5:function(t,e,r){"use strict";r.d(e,"a",(function(){return s}));var n=!1,s={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack;n=t},get useDeprecatedSynchronousErrorHandling(){return n}}},6:function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=function(){function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t}()},7:function(t,e,r){"use strict";function n(t){setTimeout((function(){throw t}),0)}r.d(e,"a",(function(){return n}))},8:function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}()},97:function(t,e,r){"use strict";r.r(e);const n=new(r(3).b);setTimeout((function(){n.signOut().then(()=>{location.href="login.html"}).catch(t=>{location.href="login.html"})}),1e3)}});