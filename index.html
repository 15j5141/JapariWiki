<!-- <?php
/* php-init*/

require_once(__DIR__.'/lib/module_convertHTML.php');
require_once(__DIR__.'/lib/module_login.php');
require_once(__DIR__.'/../config.php');

?>
<?php
/* php-run */

if(isset($_GET['page'])){
	$_SESSION['page']=htmlspecialchars($_GET['page'], ENT_QUOTES|ENT_HTML5);
	header( "Location: " . parse_url($_SERVER['REQUEST_URI'], PHP_URL_PATH));
}
//$page = isset($_GET['page']) ? urldecode($_GET['page']) : '';
$page = isset($_SESSION['page']) ? $_SESSION['page'] : 'FrontPage';
//$page = $page==='' ?  : '';
?> -->

<!-- html-body -->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <link rel="stylesheet" type="text/css" href="css/style.css" />
  <title>
    <!-- $JWConfig["siteTitle"] -->
  </title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script type="text/javascript" src="lib/ncmb.min.js" charset="utf-8">
  </script>
  <script type="text/javascript" src="js/text2html.js"></script>
  <script type="text/javascript" src="js/modAjaxWikiBase.js"></script>
  <script type="module">
    import JW from "/js/index_status.js";
    console.log(JW);

    JW.status.load();
    const wiki = JW.status.apps.wiki;
    window.page = wiki.page;
    console.log(page);
    JW.status.save();

    $.ajax({
      url: 'app/' + JW.status.app + '.html',
      dataType: 'html'
    }).done(data => {
      // console.log(data);
      $('#content_add').html(data);
    });

  </script>
  <script type="text/javascript">

    $(function() {
      //var
      console.log(page);
    });

  </script>
  <script src="js/index.js?"></script>
</head>

<body>
  <div class="bg-image">
  </div>
  <div id="header">
    <!-- auto ajax insert -->
    Loading Now...<br />
  </div><!-- /header-->
  <div id="content">
    <div id="content_body">
      <div id="content_add">
        Loading Now...<br /><br /><br />
        <!-- auto ajax insert -->
      </div>
    </div>
  </div>
  <div id="side">
    <div id="side_menu">
      <p class="bar">メニュー</p>
      アカウント名：
      <!-- $_SESSION['id'] --><br>
      <a href="logout.html">ログアウト</a><br />
      お知らせ<br />
      <div id="site_history">
        <div class="ajax_load" data-path="text/site_Notice.txt"></div>
      </div>
      <!-- <a href='' id="ajaxLoad_kanban">
        kanban(test)
      </a><br /> -->
      ログイン履歴<br />
      <div id="login_history">
        Loading Now...<br />
      </div>
      <div class="ajax_load" data-path="text/site_menu.txt"></div>

    </div>
    <div id="side_history">
      History<br />
      <div class="ajax_load" data-path="text/site_History.txt"></div>
    </div>
  </div>
  <div id="footer">
    Loading Now...<br />
  </div>
  <script>
    $(function() {
      // サイト内の'.ajax_load'パーツを非同期に読み込み.
      const ajax_loads = $('.ajax_load');
      for (let i = 0; i < ajax_loads.length; i++) {
        // jQueryオブジェクトを取得.
        const jq = ajax_loads.eq(i);
        // console.log(jq);
        ajaxLoad(null, jq.data('path'), function(data) {
          jq.html(data);
        });
      }

      

    });
  </script>

</body>

</html>